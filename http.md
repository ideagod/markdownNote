# http

## 1.http基本原理

### 网络地址

URL统一资源定位符

URI统一资源标识符

URN 统一资源命名符

```
URI 分成URL和URN
```

网络地址的基本信息

```
方案(http,https,ftp) 地址 资源路径
```

以字节为单位bit

http请求事务

### 报文基本格式

常见业务组件

1.隧道

ssh.盲转发,不检测



2.网关

协议转换,中间体.一次只能读一部分

3.代理

4.缓存

特殊的http代理服务器



## 1.链接

```
方案(协议)://用户:密码 @ 主机:路径 请求参数?查询#哈希值(片段)
```

## 2.协议

### URL的核心结构

file:文件系统提供的,共享文件夹 本地磁盘,共享文件系统

news:现在很少看见,历史遗留

telnet:本地通过命令行窗口

http和https协议是一样的,只是加密连接,端口

mailto:986486555@qq.com

ftp协议

使用:迅雷下载文件(现在没有了)

rtsp,rtspu 流媒体协议:视频和音乐

## http报文

http报文是在http引用程序之间发送的数据块

流入,流出上游和下游.

报文流入(inbound)原端服务器,服务器流出(outbound).

上游和下游

发起方为上游,其他都为下游

### 报文的基本格式

所有报文都是由string字符串组成的

```
	http				应用层
	TCP					传输层
	IP					网络层
网络特有的链路接口	  	  数据链路层
  物理网络硬件			物理层
```



#### 请求报文

```
方法  请求连接 通信协议版本
	 请求头
	 请求体
```

#### 响应报文

```
version协议 status状态码 reason-phrase状态
		headers响应首部
		entity-body
```

### 报文格式详解:

版本号:

```
1.11 和1.3
1.11大于1.3		点号后面要对比,11大于3
```

状态码

原因短语:给程序员看的

首部:换行回车符

主体部分:返回任意数据组成的数据块

post和put发送主体,其他只是单纯的指令

head和get一样的,只是返回的不带主体.get不包含主体,post包含主体(协议上分析)

put是推送的意思

get只能放在request-url里面,post能放在entity-body里面

##### get和post区别:http协议的基本上来讲起

trace请求会发起一个环回的判断.代理

# TCP连接的性能分析

## http事务的时延

1.解析服务

查询,连接,请求最久

2.延迟和丢包

3.http事务的慢启动

4.TCP连接的串行事务处理时延

5.并行连接不一定更快,但是看上去感觉快一些

先主文件回来再发送请求(单业务),再发起连接

不存在真正物理意义上的同步(飞秒)

6.持久连接:处理后并不关闭连接,少了一部分的时延,少了一部分的慢启动http1.1,传输速度变快

持久连接和并行连接配合使用可能是最高效的方式

http1.0+ 的"keep-alive"连接

2.现代http1.1 "persistent"连接 connection:close

7.管道连接

管道化持久连接.第一条直接发,一直发,然后一直回,不等回

post请求:非幂等请求

get请求是幂等请求

幂等性是指一次和多次请求某一个资源应该具有同样的副作用

先关输出

## web服务器会做什么

1.建立连接

2.接收请求

3.处理请求

4.访问资源

5.构建响应

6.发送响应

7.记录事务处理过程

### 服务器代理

隐藏真实客户端(正向)和服务器(反向)

​				vpn						

### 浏览器缓存

同一份文档

缓存服务器

宽带瓶颈,瞬间拥塞,距离时延

缓存命中cache hit

缓存未命中cache miss

始端用户访问加速节点时，如果该节点有*缓存*住了要被访问的数据时就叫做*命中*，如果没有的话需要回原服务器取，就是没有*命中*。

新鲜度检测

**分析**

## 客户端识别和cookie

1.个性化问候,推荐,管理信息的文档,记录会话

2.客户端识别的性别方式有很多:

​	承载用户身份信息的http首部(危险)

​	客户端ip地址跟踪,ip地址对其进行识别

​	用户登录,用认证方式来识别用户:配置首部的Authorization,www-Authenticate(401)

​	胖'URL,url中嵌入识别信息的技术(危险)'

​	cookie 

会话cookie和持久cookie

过期时间

http提供了一个原生的质询和响应框架,简化了对用户的认证过程















